//
// Created by Micheal Cowan on 9/27/19.
//

#include <gtest/gtest.h> // googletest header file

#include <common/Common_Deffinitions.h>
#include <streams/FM.h>
#include <string>
#include <iomanip>
using std::string;
using namespace std;

TEST(FM, modulate)
{
    uint8_t inputStream[] = {1,1,0,1,0,0,1,0,0,0};
    const RADIO_DATA_TYPE modulatedStream[] = {0.141421356237310,0.0437016024448821,-0.114412280563537,-0.114412280563537,0.0437016024448821,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448821,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448820,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448820,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448814,-0.114412280563537,-0.114412280563537,0.0437016024448818,0.141421356237310,0.0437016024448824,-0.114412280563537,-0.114412280563537,0.0437016024448818,0.141421356237310,0.0437016024448815,-0.114412280563537,-0.114412280563536,0.0437016024448818,0.141421356237310,0.0437016024448825,-0.114412280563537,-0.114412280563537,0.0437016024448808,0.141421356237310,0.0437016024448835,-0.114412280563537,-0.114412280563537,0.0437016024448798,0.141421356237310,0.0437016024448845,-0.114412280563536,-0.114412280563538,0.0437016024448807,0.141421356237310,0.0437016024448835,-0.114412280563537,-0.114412280563538,0.0437016024448816,0.141421356237310,0.0437016024448826,-0.114412280563537,-0.114412280563537,0.0437016024448825,0.141421356237310,0.0437016024448817,-0.114412280563537,-0.114412280563538,0.0437016024448816,0.141421356237310,0.0437016024448827,-0.114412280563536,-0.114412280563537,0.0437016024448825,0.141421356237310,0.0437016024448818,-0.114412280563535,-0.114412280563538,0.0437016024448815,0.141421356237310,0.0437016024448827,-0.114412280563536,-0.114412280563537,0.0437016024448805,0.141421356237310,0.0437016024448821,-0.114412280563537,-0.114412280563537,0.0437016024448821,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448821,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448820,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448820,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448814,-0.114412280563537,-0.114412280563537,0.0437016024448818,0.141421356237310,0.0437016024448824,-0.114412280563537,-0.114412280563537,0.0437016024448818,0.141421356237310,0.0437016024448815,-0.114412280563537,-0.114412280563536,0.0437016024448818,0.141421356237310,0.0437016024448825,-0.114412280563537,-0.114412280563537,0.0437016024448808,0.141421356237310,0.0437016024448835,-0.114412280563537,-0.114412280563537,0.0437016024448798,0.141421356237310,0.0437016024448845,-0.114412280563536,-0.114412280563538,0.0437016024448807,0.141421356237310,0.0437016024448835,-0.114412280563537,-0.114412280563538,0.0437016024448816,0.141421356237310,0.0437016024448826,-0.114412280563537,-0.114412280563537,0.0437016024448825,0.141421356237310,0.0437016024448817,-0.114412280563537,-0.114412280563538,0.0437016024448816,0.141421356237310,0.0437016024448827,-0.114412280563536,-0.114412280563537,0.0437016024448825,0.141421356237310,0.0437016024448818,-0.114412280563535,-0.114412280563538,0.0437016024448815,0.141421356237310,0.0437016024448827,-0.114412280563536,-0.114412280563537,0.0437016024448805,0.141421356237310,0.114412280563537,0.0437016024448821,-0.0437016024448821,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448821,0.0437016024448821,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448821,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448822,0.0437016024448821,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448820,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448822,0.0437016024448820,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448820,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448822,0.0437016024448820,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448820,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448818,0.0437016024448819,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448823,-0.0437016024448824,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448818,0.0437016024448819,0.114412280563536,0.141421356237310,0.114412280563537,0.0437016024448823,-0.0437016024448824,-0.114412280563536,-0.141421356237310,-0.114412280563538,-0.0437016024448828,0.0437016024448809,0.114412280563536,0.141421356237310,0.114412280563537,0.0437016024448823,-0.0437016024448814,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448819,0.0437016024448819,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448824,-0.0437016024448814,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448829,0.0437016024448818,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448834,-0.0437016024448813,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448829,0.0437016024448818,0.114412280563536,0.141421356237310,0.0437016024448821,-0.114412280563537,-0.114412280563537,0.0437016024448821,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448821,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448820,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448820,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448814,-0.114412280563537,-0.114412280563537,0.0437016024448818,0.141421356237310,0.0437016024448824,-0.114412280563537,-0.114412280563537,0.0437016024448818,0.141421356237310,0.0437016024448815,-0.114412280563537,-0.114412280563536,0.0437016024448818,0.141421356237310,0.0437016024448825,-0.114412280563537,-0.114412280563537,0.0437016024448808,0.141421356237310,0.0437016024448835,-0.114412280563537,-0.114412280563537,0.0437016024448798,0.141421356237310,0.0437016024448845,-0.114412280563536,-0.114412280563538,0.0437016024448807,0.141421356237310,0.0437016024448835,-0.114412280563537,-0.114412280563538,0.0437016024448816,0.141421356237310,0.0437016024448826,-0.114412280563537,-0.114412280563537,0.0437016024448825,0.141421356237310,0.0437016024448817,-0.114412280563537,-0.114412280563538,0.0437016024448816,0.141421356237310,0.0437016024448827,-0.114412280563536,-0.114412280563537,0.0437016024448825,0.141421356237310,0.0437016024448818,-0.114412280563535,-0.114412280563538,0.0437016024448815,0.141421356237310,0.0437016024448827,-0.114412280563536,-0.114412280563537,0.0437016024448805,0.141421356237310,0.114412280563537,0.0437016024448821,-0.0437016024448821,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448821,0.0437016024448821,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448821,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448822,0.0437016024448821,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448820,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448822,0.0437016024448820,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448820,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448822,0.0437016024448820,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448820,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448818,0.0437016024448819,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448823,-0.0437016024448824,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448818,0.0437016024448819,0.114412280563536,0.141421356237310,0.114412280563537,0.0437016024448823,-0.0437016024448824,-0.114412280563536,-0.141421356237310,-0.114412280563538,-0.0437016024448828,0.0437016024448809,0.114412280563536,0.141421356237310,0.114412280563537,0.0437016024448823,-0.0437016024448814,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448819,0.0437016024448819,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448824,-0.0437016024448814,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448829,0.0437016024448818,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448834,-0.0437016024448813,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448829,0.0437016024448818,0.114412280563536,0.141421356237310,0.114412280563537,0.0437016024448821,-0.0437016024448821,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448821,0.0437016024448821,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448821,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448822,0.0437016024448821,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448820,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448822,0.0437016024448820,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448820,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448822,0.0437016024448820,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448820,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448818,0.0437016024448819,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448823,-0.0437016024448824,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448818,0.0437016024448819,0.114412280563536,0.141421356237310,0.114412280563537,0.0437016024448823,-0.0437016024448824,-0.114412280563536,-0.141421356237310,-0.114412280563538,-0.0437016024448828,0.0437016024448809,0.114412280563536,0.141421356237310,0.114412280563537,0.0437016024448823,-0.0437016024448814,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448819,0.0437016024448819,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448824,-0.0437016024448814,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448829,0.0437016024448818,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448834,-0.0437016024448813,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448829,0.0437016024448818,0.114412280563536,0.141421356237310,0.0437016024448821,-0.114412280563537,-0.114412280563537,0.0437016024448821,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448821,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448820,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448820,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448814,-0.114412280563537,-0.114412280563537,0.0437016024448818,0.141421356237310,0.0437016024448824,-0.114412280563537,-0.114412280563537,0.0437016024448818,0.141421356237310,0.0437016024448815,-0.114412280563537,-0.114412280563536,0.0437016024448818,0.141421356237310,0.0437016024448825,-0.114412280563537,-0.114412280563537,0.0437016024448808,0.141421356237310,0.0437016024448835,-0.114412280563537,-0.114412280563537,0.0437016024448798,0.141421356237310,0.0437016024448845,-0.114412280563536,-0.114412280563538,0.0437016024448807,0.141421356237310,0.0437016024448835,-0.114412280563537,-0.114412280563538,0.0437016024448816,0.141421356237310,0.0437016024448826,-0.114412280563537,-0.114412280563537,0.0437016024448825,0.141421356237310,0.0437016024448817,-0.114412280563537,-0.114412280563538,0.0437016024448816,0.141421356237310,0.0437016024448827,-0.114412280563536,-0.114412280563537,0.0437016024448825,0.141421356237310,0.0437016024448818,-0.114412280563535,-0.114412280563538,0.0437016024448815,0.141421356237310,0.0437016024448827,-0.114412280563536,-0.114412280563537,0.0437016024448805,0.141421356237310,0.114412280563537,0.0437016024448821,-0.0437016024448821,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448821,0.0437016024448821,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448821,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448822,0.0437016024448821,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448820,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448822,0.0437016024448820,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448820,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448822,0.0437016024448820,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448820,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448818,0.0437016024448819,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448823,-0.0437016024448824,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448818,0.0437016024448819,0.114412280563536,0.141421356237310,0.114412280563537,0.0437016024448823,-0.0437016024448824,-0.114412280563536,-0.141421356237310,-0.114412280563538,-0.0437016024448828,0.0437016024448809,0.114412280563536,0.141421356237310,0.114412280563537,0.0437016024448823,-0.0437016024448814,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448819,0.0437016024448819,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448824,-0.0437016024448814,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448829,0.0437016024448818,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448834,-0.0437016024448813,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448829,0.0437016024448818,0.114412280563536,0.141421356237310,0.114412280563537,0.0437016024448821,-0.0437016024448821,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448821,0.0437016024448821,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448821,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448822,0.0437016024448821,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448820,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448822,0.0437016024448820,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448820,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448822,0.0437016024448820,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448820,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448818,0.0437016024448819,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448823,-0.0437016024448824,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448818,0.0437016024448819,0.114412280563536,0.141421356237310,0.114412280563537,0.0437016024448823,-0.0437016024448824,-0.114412280563536,-0.141421356237310,-0.114412280563538,-0.0437016024448828,0.0437016024448809,0.114412280563536,0.141421356237310,0.114412280563537,0.0437016024448823,-0.0437016024448814,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448819,0.0437016024448819,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448824,-0.0437016024448814,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448829,0.0437016024448818,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448834,-0.0437016024448813,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448829,0.0437016024448818,0.114412280563536,0.141421356237310,0.114412280563537,0.0437016024448821,-0.0437016024448821,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448821,0.0437016024448821,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448821,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448822,0.0437016024448821,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448820,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448822,0.0437016024448820,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448820,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448822,0.0437016024448820,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448820,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448818,0.0437016024448819,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448823,-0.0437016024448824,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448818,0.0437016024448819,0.114412280563536,0.141421356237310,0.114412280563537,0.0437016024448823,-0.0437016024448824,-0.114412280563536,-0.141421356237310,-0.114412280563538,-0.0437016024448828,0.0437016024448809,0.114412280563536,0.141421356237310,0.114412280563537,0.0437016024448823,-0.0437016024448814,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448819,0.0437016024448819,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448824,-0.0437016024448814,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448829,0.0437016024448818,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448834,-0.0437016024448813,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448829,0.0437016024448818,0.114412280563536};

    RADIO_DATA_TYPE* modulated_real = new RADIO_DATA_TYPE[100*10];
    RADIO_DATA_TYPE* modulated_imag = new RADIO_DATA_TYPE[100*10];

    memset(modulated_real, 0, 100*10*sizeof(RADIO_DATA_TYPE));
    memset(modulated_imag, 0, 100*10*sizeof(RADIO_DATA_TYPE));

    FM<RADIO_DATA_TYPE> fm(100,10);

    fm.modulate(inputStream, 10, modulated_real, modulated_imag, 1000);

    for(size_t i = 0; i < 10*100; i++)
    {
        std::cout << i << "  " << modulated_real[i] << "  " << modulatedStream[i] << std::endl;
       // ASSERT_NEAR(modulated_real[i], modulatedStream[i], 0.000000001) << "Failed at index " << i << "  " << inputStream[i] << "  " << modulatedStream[i];
    }

    delete[] modulated_real;
    delete[] modulated_imag;
}


TEST(FM, demodulate)
{
    const size_t input_stream_size = 1000;
    RADIO_DATA_TYPE modulatedRealStream[] = {0.141421356237310,0.0437016024448821,-0.114412280563537,-0.114412280563537,0.0437016024448821,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448821,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448820,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448820,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448814,-0.114412280563537,-0.114412280563537,0.0437016024448818,0.141421356237310,0.0437016024448824,-0.114412280563537,-0.114412280563537,0.0437016024448818,0.141421356237310,0.0437016024448815,-0.114412280563537,-0.114412280563536,0.0437016024448818,0.141421356237310,0.0437016024448825,-0.114412280563537,-0.114412280563537,0.0437016024448808,0.141421356237310,0.0437016024448835,-0.114412280563537,-0.114412280563537,0.0437016024448798,0.141421356237310,0.0437016024448845,-0.114412280563536,-0.114412280563538,0.0437016024448807,0.141421356237310,0.0437016024448835,-0.114412280563537,-0.114412280563538,0.0437016024448816,0.141421356237310,0.0437016024448826,-0.114412280563537,-0.114412280563537,0.0437016024448825,0.141421356237310,0.0437016024448817,-0.114412280563537,-0.114412280563538,0.0437016024448816,0.141421356237310,0.0437016024448827,-0.114412280563536,-0.114412280563537,0.0437016024448825,0.141421356237310,0.0437016024448818,-0.114412280563535,-0.114412280563538,0.0437016024448815,0.141421356237310,0.0437016024448827,-0.114412280563536,-0.114412280563537,0.0437016024448805,0.141421356237310,0.0437016024448821,-0.114412280563537,-0.114412280563537,0.0437016024448821,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448821,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448820,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448820,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448814,-0.114412280563537,-0.114412280563537,0.0437016024448818,0.141421356237310,0.0437016024448824,-0.114412280563537,-0.114412280563537,0.0437016024448818,0.141421356237310,0.0437016024448815,-0.114412280563537,-0.114412280563536,0.0437016024448818,0.141421356237310,0.0437016024448825,-0.114412280563537,-0.114412280563537,0.0437016024448808,0.141421356237310,0.0437016024448835,-0.114412280563537,-0.114412280563537,0.0437016024448798,0.141421356237310,0.0437016024448845,-0.114412280563536,-0.114412280563538,0.0437016024448807,0.141421356237310,0.0437016024448835,-0.114412280563537,-0.114412280563538,0.0437016024448816,0.141421356237310,0.0437016024448826,-0.114412280563537,-0.114412280563537,0.0437016024448825,0.141421356237310,0.0437016024448817,-0.114412280563537,-0.114412280563538,0.0437016024448816,0.141421356237310,0.0437016024448827,-0.114412280563536,-0.114412280563537,0.0437016024448825,0.141421356237310,0.0437016024448818,-0.114412280563535,-0.114412280563538,0.0437016024448815,0.141421356237310,0.0437016024448827,-0.114412280563536,-0.114412280563537,0.0437016024448805,0.141421356237310,0.0437016024448821,-0.114412280563537,-0.114412280563537,0.0437016024448821,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448821,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448820,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448820,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448814,-0.114412280563537,-0.114412280563537,0.0437016024448818,0.141421356237310,0.0437016024448824,-0.114412280563537,-0.114412280563537,0.0437016024448818,0.141421356237310,0.0437016024448815,-0.114412280563537,-0.114412280563536,0.0437016024448818,0.141421356237310,0.0437016024448825,-0.114412280563537,-0.114412280563537,0.0437016024448808,0.141421356237310,0.0437016024448835,-0.114412280563537,-0.114412280563537,0.0437016024448798,0.141421356237310,0.0437016024448845,-0.114412280563536,-0.114412280563538,0.0437016024448807,0.141421356237310,0.0437016024448835,-0.114412280563537,-0.114412280563538,0.0437016024448816,0.141421356237310,0.0437016024448826,-0.114412280563537,-0.114412280563537,0.0437016024448825,0.141421356237310,0.0437016024448817,-0.114412280563537,-0.114412280563538,0.0437016024448816,0.141421356237310,0.0437016024448827,-0.114412280563536,-0.114412280563537,0.0437016024448825,0.141421356237310,0.0437016024448818,-0.114412280563535,-0.114412280563538,0.0437016024448815,0.141421356237310,0.0437016024448827,-0.114412280563536,-0.114412280563537,0.0437016024448805,0.141421356237310,0.114412280563537,0.0437016024448821,-0.0437016024448821,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448821,0.0437016024448821,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448821,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448822,0.0437016024448821,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448820,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448822,0.0437016024448820,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448820,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448822,0.0437016024448820,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448820,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448818,0.0437016024448819,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448823,-0.0437016024448824,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448818,0.0437016024448819,0.114412280563536,0.141421356237310,0.114412280563537,0.0437016024448823,-0.0437016024448824,-0.114412280563536,-0.141421356237310,-0.114412280563538,-0.0437016024448828,0.0437016024448809,0.114412280563536,0.141421356237310,0.114412280563537,0.0437016024448823,-0.0437016024448814,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448819,0.0437016024448819,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448824,-0.0437016024448814,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448829,0.0437016024448818,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448834,-0.0437016024448813,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448829,0.0437016024448818,0.114412280563536,0.141421356237310,0.114412280563537,0.0437016024448821,-0.0437016024448821,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448821,0.0437016024448821,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448821,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448822,0.0437016024448821,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448820,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448822,0.0437016024448820,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448820,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448822,0.0437016024448820,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448820,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448818,0.0437016024448819,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448823,-0.0437016024448824,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448818,0.0437016024448819,0.114412280563536,0.141421356237310,0.114412280563537,0.0437016024448823,-0.0437016024448824,-0.114412280563536,-0.141421356237310,-0.114412280563538,-0.0437016024448828,0.0437016024448809,0.114412280563536,0.141421356237310,0.114412280563537,0.0437016024448823,-0.0437016024448814,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448819,0.0437016024448819,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448824,-0.0437016024448814,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448829,0.0437016024448818,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448834,-0.0437016024448813,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448829,0.0437016024448818,0.114412280563536,0.141421356237310,0.114412280563537,0.0437016024448821,-0.0437016024448821,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448821,0.0437016024448821,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448821,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448822,0.0437016024448821,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448820,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448822,0.0437016024448820,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448820,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448822,0.0437016024448820,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448820,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448818,0.0437016024448819,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448823,-0.0437016024448824,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448818,0.0437016024448819,0.114412280563536,0.141421356237310,0.114412280563537,0.0437016024448823,-0.0437016024448824,-0.114412280563536,-0.141421356237310,-0.114412280563538,-0.0437016024448828,0.0437016024448809,0.114412280563536,0.141421356237310,0.114412280563537,0.0437016024448823,-0.0437016024448814,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448819,0.0437016024448819,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448824,-0.0437016024448814,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448829,0.0437016024448818,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448834,-0.0437016024448813,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448829,0.0437016024448818,0.114412280563536,0.141421356237310,0.0437016024448821,-0.114412280563537,-0.114412280563537,0.0437016024448821,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448821,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448820,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448820,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448814,-0.114412280563537,-0.114412280563537,0.0437016024448818,0.141421356237310,0.0437016024448824,-0.114412280563537,-0.114412280563537,0.0437016024448818,0.141421356237310,0.0437016024448815,-0.114412280563537,-0.114412280563536,0.0437016024448818,0.141421356237310,0.0437016024448825,-0.114412280563537,-0.114412280563537,0.0437016024448808,0.141421356237310,0.0437016024448835,-0.114412280563537,-0.114412280563537,0.0437016024448798,0.141421356237310,0.0437016024448845,-0.114412280563536,-0.114412280563538,0.0437016024448807,0.141421356237310,0.0437016024448835,-0.114412280563537,-0.114412280563538,0.0437016024448816,0.141421356237310,0.0437016024448826,-0.114412280563537,-0.114412280563537,0.0437016024448825,0.141421356237310,0.0437016024448817,-0.114412280563537,-0.114412280563538,0.0437016024448816,0.141421356237310,0.0437016024448827,-0.114412280563536,-0.114412280563537,0.0437016024448825,0.141421356237310,0.0437016024448818,-0.114412280563535,-0.114412280563538,0.0437016024448815,0.141421356237310,0.0437016024448827,-0.114412280563536,-0.114412280563537,0.0437016024448805,0.141421356237310,0.0437016024448821,-0.114412280563537,-0.114412280563537,0.0437016024448821,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448821,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448820,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448820,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448814,-0.114412280563537,-0.114412280563537,0.0437016024448818,0.141421356237310,0.0437016024448824,-0.114412280563537,-0.114412280563537,0.0437016024448818,0.141421356237310,0.0437016024448815,-0.114412280563537,-0.114412280563536,0.0437016024448818,0.141421356237310,0.0437016024448825,-0.114412280563537,-0.114412280563537,0.0437016024448808,0.141421356237310,0.0437016024448835,-0.114412280563537,-0.114412280563537,0.0437016024448798,0.141421356237310,0.0437016024448845,-0.114412280563536,-0.114412280563538,0.0437016024448807,0.141421356237310,0.0437016024448835,-0.114412280563537,-0.114412280563538,0.0437016024448816,0.141421356237310,0.0437016024448826,-0.114412280563537,-0.114412280563537,0.0437016024448825,0.141421356237310,0.0437016024448817,-0.114412280563537,-0.114412280563538,0.0437016024448816,0.141421356237310,0.0437016024448827,-0.114412280563536,-0.114412280563537,0.0437016024448825,0.141421356237310,0.0437016024448818,-0.114412280563535,-0.114412280563538,0.0437016024448815,0.141421356237310,0.0437016024448827,-0.114412280563536,-0.114412280563537,0.0437016024448805,0.141421356237310,0.114412280563537,0.0437016024448821,-0.0437016024448821,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448821,0.0437016024448821,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448821,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448822,0.0437016024448821,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448820,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448822,0.0437016024448820,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448820,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448822,0.0437016024448820,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448820,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448818,0.0437016024448819,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448823,-0.0437016024448824,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448818,0.0437016024448819,0.114412280563536,0.141421356237310,0.114412280563537,0.0437016024448823,-0.0437016024448824,-0.114412280563536,-0.141421356237310,-0.114412280563538,-0.0437016024448828,0.0437016024448809,0.114412280563536,0.141421356237310,0.114412280563537,0.0437016024448823,-0.0437016024448814,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448819,0.0437016024448819,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448824,-0.0437016024448814,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448829,0.0437016024448818,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448834,-0.0437016024448813,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448829,0.0437016024448818,0.114412280563536,0.141421356237310,0.0437016024448821,-0.114412280563537,-0.114412280563537,0.0437016024448821,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448821,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448820,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448820,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448814,-0.114412280563537,-0.114412280563537,0.0437016024448818,0.141421356237310,0.0437016024448824,-0.114412280563537,-0.114412280563537,0.0437016024448818,0.141421356237310,0.0437016024448815,-0.114412280563537,-0.114412280563536,0.0437016024448818,0.141421356237310,0.0437016024448825,-0.114412280563537,-0.114412280563537,0.0437016024448808,0.141421356237310,0.0437016024448835,-0.114412280563537,-0.114412280563537,0.0437016024448798,0.141421356237310,0.0437016024448845,-0.114412280563536,-0.114412280563538,0.0437016024448807,0.141421356237310,0.0437016024448835,-0.114412280563537,-0.114412280563538,0.0437016024448816,0.141421356237310,0.0437016024448826,-0.114412280563537,-0.114412280563537,0.0437016024448825,0.141421356237310,0.0437016024448817,-0.114412280563537,-0.114412280563538,0.0437016024448816,0.141421356237310,0.0437016024448827,-0.114412280563536,-0.114412280563537,0.0437016024448825,0.141421356237310,0.0437016024448818,-0.114412280563535,-0.114412280563538,0.0437016024448815,0.141421356237310,0.0437016024448827,-0.114412280563536,-0.114412280563537,0.0437016024448805};
    RADIO_DATA_TYPE modulatedImagStream[] = {0.141421356237310,0.0437016024448821,-0.114412280563537,-0.114412280563537,0.0437016024448821,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448821,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448820,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448820,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448814,-0.114412280563537,-0.114412280563537,0.0437016024448818,0.141421356237310,0.0437016024448824,-0.114412280563537,-0.114412280563537,0.0437016024448818,0.141421356237310,0.0437016024448815,-0.114412280563537,-0.114412280563536,0.0437016024448818,0.141421356237310,0.0437016024448825,-0.114412280563537,-0.114412280563537,0.0437016024448808,0.141421356237310,0.0437016024448835,-0.114412280563537,-0.114412280563537,0.0437016024448798,0.141421356237310,0.0437016024448845,-0.114412280563536,-0.114412280563538,0.0437016024448807,0.141421356237310,0.0437016024448835,-0.114412280563537,-0.114412280563538,0.0437016024448816,0.141421356237310,0.0437016024448826,-0.114412280563537,-0.114412280563537,0.0437016024448825,0.141421356237310,0.0437016024448817,-0.114412280563537,-0.114412280563538,0.0437016024448816,0.141421356237310,0.0437016024448827,-0.114412280563536,-0.114412280563537,0.0437016024448825,0.141421356237310,0.0437016024448818,-0.114412280563535,-0.114412280563538,0.0437016024448815,0.141421356237310,0.0437016024448827,-0.114412280563536,-0.114412280563537,0.0437016024448805,0.141421356237310,0.0437016024448821,-0.114412280563537,-0.114412280563537,0.0437016024448821,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448821,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448820,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448820,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448814,-0.114412280563537,-0.114412280563537,0.0437016024448818,0.141421356237310,0.0437016024448824,-0.114412280563537,-0.114412280563537,0.0437016024448818,0.141421356237310,0.0437016024448815,-0.114412280563537,-0.114412280563536,0.0437016024448818,0.141421356237310,0.0437016024448825,-0.114412280563537,-0.114412280563537,0.0437016024448808,0.141421356237310,0.0437016024448835,-0.114412280563537,-0.114412280563537,0.0437016024448798,0.141421356237310,0.0437016024448845,-0.114412280563536,-0.114412280563538,0.0437016024448807,0.141421356237310,0.0437016024448835,-0.114412280563537,-0.114412280563538,0.0437016024448816,0.141421356237310,0.0437016024448826,-0.114412280563537,-0.114412280563537,0.0437016024448825,0.141421356237310,0.0437016024448817,-0.114412280563537,-0.114412280563538,0.0437016024448816,0.141421356237310,0.0437016024448827,-0.114412280563536,-0.114412280563537,0.0437016024448825,0.141421356237310,0.0437016024448818,-0.114412280563535,-0.114412280563538,0.0437016024448815,0.141421356237310,0.0437016024448827,-0.114412280563536,-0.114412280563537,0.0437016024448805,0.141421356237310,0.0437016024448821,-0.114412280563537,-0.114412280563537,0.0437016024448821,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448821,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448820,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448820,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448814,-0.114412280563537,-0.114412280563537,0.0437016024448818,0.141421356237310,0.0437016024448824,-0.114412280563537,-0.114412280563537,0.0437016024448818,0.141421356237310,0.0437016024448815,-0.114412280563537,-0.114412280563536,0.0437016024448818,0.141421356237310,0.0437016024448825,-0.114412280563537,-0.114412280563537,0.0437016024448808,0.141421356237310,0.0437016024448835,-0.114412280563537,-0.114412280563537,0.0437016024448798,0.141421356237310,0.0437016024448845,-0.114412280563536,-0.114412280563538,0.0437016024448807,0.141421356237310,0.0437016024448835,-0.114412280563537,-0.114412280563538,0.0437016024448816,0.141421356237310,0.0437016024448826,-0.114412280563537,-0.114412280563537,0.0437016024448825,0.141421356237310,0.0437016024448817,-0.114412280563537,-0.114412280563538,0.0437016024448816,0.141421356237310,0.0437016024448827,-0.114412280563536,-0.114412280563537,0.0437016024448825,0.141421356237310,0.0437016024448818,-0.114412280563535,-0.114412280563538,0.0437016024448815,0.141421356237310,0.0437016024448827,-0.114412280563536,-0.114412280563537,0.0437016024448805,0.141421356237310,0.114412280563537,0.0437016024448821,-0.0437016024448821,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448821,0.0437016024448821,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448821,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448822,0.0437016024448821,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448820,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448822,0.0437016024448820,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448820,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448822,0.0437016024448820,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448820,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448818,0.0437016024448819,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448823,-0.0437016024448824,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448818,0.0437016024448819,0.114412280563536,0.141421356237310,0.114412280563537,0.0437016024448823,-0.0437016024448824,-0.114412280563536,-0.141421356237310,-0.114412280563538,-0.0437016024448828,0.0437016024448809,0.114412280563536,0.141421356237310,0.114412280563537,0.0437016024448823,-0.0437016024448814,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448819,0.0437016024448819,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448824,-0.0437016024448814,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448829,0.0437016024448818,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448834,-0.0437016024448813,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448829,0.0437016024448818,0.114412280563536,0.141421356237310,0.114412280563537,0.0437016024448821,-0.0437016024448821,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448821,0.0437016024448821,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448821,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448822,0.0437016024448821,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448820,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448822,0.0437016024448820,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448820,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448822,0.0437016024448820,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448820,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448818,0.0437016024448819,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448823,-0.0437016024448824,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448818,0.0437016024448819,0.114412280563536,0.141421356237310,0.114412280563537,0.0437016024448823,-0.0437016024448824,-0.114412280563536,-0.141421356237310,-0.114412280563538,-0.0437016024448828,0.0437016024448809,0.114412280563536,0.141421356237310,0.114412280563537,0.0437016024448823,-0.0437016024448814,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448819,0.0437016024448819,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448824,-0.0437016024448814,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448829,0.0437016024448818,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448834,-0.0437016024448813,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448829,0.0437016024448818,0.114412280563536,0.141421356237310,0.114412280563537,0.0437016024448821,-0.0437016024448821,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448821,0.0437016024448821,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448821,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448822,0.0437016024448821,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448820,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448822,0.0437016024448820,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448820,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448822,0.0437016024448820,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448820,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448818,0.0437016024448819,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448823,-0.0437016024448824,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448818,0.0437016024448819,0.114412280563536,0.141421356237310,0.114412280563537,0.0437016024448823,-0.0437016024448824,-0.114412280563536,-0.141421356237310,-0.114412280563538,-0.0437016024448828,0.0437016024448809,0.114412280563536,0.141421356237310,0.114412280563537,0.0437016024448823,-0.0437016024448814,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448819,0.0437016024448819,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448824,-0.0437016024448814,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448829,0.0437016024448818,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448834,-0.0437016024448813,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448829,0.0437016024448818,0.114412280563536,0.141421356237310,0.0437016024448821,-0.114412280563537,-0.114412280563537,0.0437016024448821,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448821,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448820,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448820,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448814,-0.114412280563537,-0.114412280563537,0.0437016024448818,0.141421356237310,0.0437016024448824,-0.114412280563537,-0.114412280563537,0.0437016024448818,0.141421356237310,0.0437016024448815,-0.114412280563537,-0.114412280563536,0.0437016024448818,0.141421356237310,0.0437016024448825,-0.114412280563537,-0.114412280563537,0.0437016024448808,0.141421356237310,0.0437016024448835,-0.114412280563537,-0.114412280563537,0.0437016024448798,0.141421356237310,0.0437016024448845,-0.114412280563536,-0.114412280563538,0.0437016024448807,0.141421356237310,0.0437016024448835,-0.114412280563537,-0.114412280563538,0.0437016024448816,0.141421356237310,0.0437016024448826,-0.114412280563537,-0.114412280563537,0.0437016024448825,0.141421356237310,0.0437016024448817,-0.114412280563537,-0.114412280563538,0.0437016024448816,0.141421356237310,0.0437016024448827,-0.114412280563536,-0.114412280563537,0.0437016024448825,0.141421356237310,0.0437016024448818,-0.114412280563535,-0.114412280563538,0.0437016024448815,0.141421356237310,0.0437016024448827,-0.114412280563536,-0.114412280563537,0.0437016024448805,0.141421356237310,0.0437016024448821,-0.114412280563537,-0.114412280563537,0.0437016024448821,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448821,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448820,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448820,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448814,-0.114412280563537,-0.114412280563537,0.0437016024448818,0.141421356237310,0.0437016024448824,-0.114412280563537,-0.114412280563537,0.0437016024448818,0.141421356237310,0.0437016024448815,-0.114412280563537,-0.114412280563536,0.0437016024448818,0.141421356237310,0.0437016024448825,-0.114412280563537,-0.114412280563537,0.0437016024448808,0.141421356237310,0.0437016024448835,-0.114412280563537,-0.114412280563537,0.0437016024448798,0.141421356237310,0.0437016024448845,-0.114412280563536,-0.114412280563538,0.0437016024448807,0.141421356237310,0.0437016024448835,-0.114412280563537,-0.114412280563538,0.0437016024448816,0.141421356237310,0.0437016024448826,-0.114412280563537,-0.114412280563537,0.0437016024448825,0.141421356237310,0.0437016024448817,-0.114412280563537,-0.114412280563538,0.0437016024448816,0.141421356237310,0.0437016024448827,-0.114412280563536,-0.114412280563537,0.0437016024448825,0.141421356237310,0.0437016024448818,-0.114412280563535,-0.114412280563538,0.0437016024448815,0.141421356237310,0.0437016024448827,-0.114412280563536,-0.114412280563537,0.0437016024448805,0.141421356237310,0.114412280563537,0.0437016024448821,-0.0437016024448821,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448821,0.0437016024448821,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448821,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448822,0.0437016024448821,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448820,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448822,0.0437016024448820,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448820,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448822,0.0437016024448820,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448820,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448818,0.0437016024448819,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448823,-0.0437016024448824,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448818,0.0437016024448819,0.114412280563536,0.141421356237310,0.114412280563537,0.0437016024448823,-0.0437016024448824,-0.114412280563536,-0.141421356237310,-0.114412280563538,-0.0437016024448828,0.0437016024448809,0.114412280563536,0.141421356237310,0.114412280563537,0.0437016024448823,-0.0437016024448814,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448819,0.0437016024448819,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448824,-0.0437016024448814,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448829,0.0437016024448818,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448834,-0.0437016024448813,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448829,0.0437016024448818,0.114412280563536,0.141421356237310,0.0437016024448821,-0.114412280563537,-0.114412280563537,0.0437016024448821,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448821,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448820,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448820,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448814,-0.114412280563537,-0.114412280563537,0.0437016024448818,0.141421356237310,0.0437016024448824,-0.114412280563537,-0.114412280563537,0.0437016024448818,0.141421356237310,0.0437016024448815,-0.114412280563537,-0.114412280563536,0.0437016024448818,0.141421356237310,0.0437016024448825,-0.114412280563537,-0.114412280563537,0.0437016024448808,0.141421356237310,0.0437016024448835,-0.114412280563537,-0.114412280563537,0.0437016024448798,0.141421356237310,0.0437016024448845,-0.114412280563536,-0.114412280563538,0.0437016024448807,0.141421356237310,0.0437016024448835,-0.114412280563537,-0.114412280563538,0.0437016024448816,0.141421356237310,0.0437016024448826,-0.114412280563537,-0.114412280563537,0.0437016024448825,0.141421356237310,0.0437016024448817,-0.114412280563537,-0.114412280563538,0.0437016024448816,0.141421356237310,0.0437016024448827,-0.114412280563536,-0.114412280563537,0.0437016024448825,0.141421356237310,0.0437016024448818,-0.114412280563535,-0.114412280563538,0.0437016024448815,0.141421356237310,0.0437016024448827,-0.114412280563536,-0.114412280563537,0.0437016024448805};

    const uint8_t outputStream[] = {1,1,1,0,0,0,1,1,0,1};

    uint8_t outputDemod[10] = {0};
    memset(modulatedImagStream, 0, sizeof(RADIO_DATA_TYPE)*1000);

    FM<RADIO_DATA_TYPE> fm(100,100, 20, 10);

    ASSERT_EQ(fm.demodulate(modulatedRealStream, modulatedImagStream, outputDemod, 1000, 100), 10);

    for(size_t i = 0; i < 10; i++)
    {
        ASSERT_EQ(outputDemod[i], outputStream[i]) << "Failed at index " << i;
    }
}

TEST(FM, ModDemodResampled)
{
    uint8_t inputStream[] = {1,1,1,0,0,0,1,1,0,1};
    const size_t input_stream_size = 1000;
    RADIO_DATA_TYPE* modulated_real = new RADIO_DATA_TYPE[input_stream_size];
    RADIO_DATA_TYPE* modulated_imag = new RADIO_DATA_TYPE[input_stream_size];
    RADIO_DATA_TYPE modulatedStream[] = {0.141421356237310,0.0437016024448821,-0.114412280563537,-0.114412280563537,0.0437016024448821,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448821,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448820,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448820,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448814,-0.114412280563537,-0.114412280563537,0.0437016024448818,0.141421356237310,0.0437016024448824,-0.114412280563537,-0.114412280563537,0.0437016024448818,0.141421356237310,0.0437016024448815,-0.114412280563537,-0.114412280563536,0.0437016024448818,0.141421356237310,0.0437016024448825,-0.114412280563537,-0.114412280563537,0.0437016024448808,0.141421356237310,0.0437016024448835,-0.114412280563537,-0.114412280563537,0.0437016024448798,0.141421356237310,0.0437016024448845,-0.114412280563536,-0.114412280563538,0.0437016024448807,0.141421356237310,0.0437016024448835,-0.114412280563537,-0.114412280563538,0.0437016024448816,0.141421356237310,0.0437016024448826,-0.114412280563537,-0.114412280563537,0.0437016024448825,0.141421356237310,0.0437016024448817,-0.114412280563537,-0.114412280563538,0.0437016024448816,0.141421356237310,0.0437016024448827,-0.114412280563536,-0.114412280563537,0.0437016024448825,0.141421356237310,0.0437016024448818,-0.114412280563535,-0.114412280563538,0.0437016024448815,0.141421356237310,0.0437016024448827,-0.114412280563536,-0.114412280563537,0.0437016024448805,0.141421356237310,0.0437016024448821,-0.114412280563537,-0.114412280563537,0.0437016024448821,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448821,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448820,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448820,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448814,-0.114412280563537,-0.114412280563537,0.0437016024448818,0.141421356237310,0.0437016024448824,-0.114412280563537,-0.114412280563537,0.0437016024448818,0.141421356237310,0.0437016024448815,-0.114412280563537,-0.114412280563536,0.0437016024448818,0.141421356237310,0.0437016024448825,-0.114412280563537,-0.114412280563537,0.0437016024448808,0.141421356237310,0.0437016024448835,-0.114412280563537,-0.114412280563537,0.0437016024448798,0.141421356237310,0.0437016024448845,-0.114412280563536,-0.114412280563538,0.0437016024448807,0.141421356237310,0.0437016024448835,-0.114412280563537,-0.114412280563538,0.0437016024448816,0.141421356237310,0.0437016024448826,-0.114412280563537,-0.114412280563537,0.0437016024448825,0.141421356237310,0.0437016024448817,-0.114412280563537,-0.114412280563538,0.0437016024448816,0.141421356237310,0.0437016024448827,-0.114412280563536,-0.114412280563537,0.0437016024448825,0.141421356237310,0.0437016024448818,-0.114412280563535,-0.114412280563538,0.0437016024448815,0.141421356237310,0.0437016024448827,-0.114412280563536,-0.114412280563537,0.0437016024448805,0.141421356237310,0.0437016024448821,-0.114412280563537,-0.114412280563537,0.0437016024448821,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448821,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448820,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448820,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448814,-0.114412280563537,-0.114412280563537,0.0437016024448818,0.141421356237310,0.0437016024448824,-0.114412280563537,-0.114412280563537,0.0437016024448818,0.141421356237310,0.0437016024448815,-0.114412280563537,-0.114412280563536,0.0437016024448818,0.141421356237310,0.0437016024448825,-0.114412280563537,-0.114412280563537,0.0437016024448808,0.141421356237310,0.0437016024448835,-0.114412280563537,-0.114412280563537,0.0437016024448798,0.141421356237310,0.0437016024448845,-0.114412280563536,-0.114412280563538,0.0437016024448807,0.141421356237310,0.0437016024448835,-0.114412280563537,-0.114412280563538,0.0437016024448816,0.141421356237310,0.0437016024448826,-0.114412280563537,-0.114412280563537,0.0437016024448825,0.141421356237310,0.0437016024448817,-0.114412280563537,-0.114412280563538,0.0437016024448816,0.141421356237310,0.0437016024448827,-0.114412280563536,-0.114412280563537,0.0437016024448825,0.141421356237310,0.0437016024448818,-0.114412280563535,-0.114412280563538,0.0437016024448815,0.141421356237310,0.0437016024448827,-0.114412280563536,-0.114412280563537,0.0437016024448805,0.141421356237310,0.114412280563537,0.0437016024448821,-0.0437016024448821,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448821,0.0437016024448821,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448821,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448822,0.0437016024448821,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448820,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448822,0.0437016024448820,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448820,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448822,0.0437016024448820,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448820,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448818,0.0437016024448819,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448823,-0.0437016024448824,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448818,0.0437016024448819,0.114412280563536,0.141421356237310,0.114412280563537,0.0437016024448823,-0.0437016024448824,-0.114412280563536,-0.141421356237310,-0.114412280563538,-0.0437016024448828,0.0437016024448809,0.114412280563536,0.141421356237310,0.114412280563537,0.0437016024448823,-0.0437016024448814,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448819,0.0437016024448819,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448824,-0.0437016024448814,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448829,0.0437016024448818,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448834,-0.0437016024448813,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448829,0.0437016024448818,0.114412280563536,0.141421356237310,0.114412280563537,0.0437016024448821,-0.0437016024448821,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448821,0.0437016024448821,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448821,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448822,0.0437016024448821,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448820,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448822,0.0437016024448820,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448820,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448822,0.0437016024448820,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448820,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448818,0.0437016024448819,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448823,-0.0437016024448824,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448818,0.0437016024448819,0.114412280563536,0.141421356237310,0.114412280563537,0.0437016024448823,-0.0437016024448824,-0.114412280563536,-0.141421356237310,-0.114412280563538,-0.0437016024448828,0.0437016024448809,0.114412280563536,0.141421356237310,0.114412280563537,0.0437016024448823,-0.0437016024448814,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448819,0.0437016024448819,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448824,-0.0437016024448814,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448829,0.0437016024448818,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448834,-0.0437016024448813,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448829,0.0437016024448818,0.114412280563536,0.141421356237310,0.114412280563537,0.0437016024448821,-0.0437016024448821,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448821,0.0437016024448821,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448821,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448822,0.0437016024448821,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448820,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448822,0.0437016024448820,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448820,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448822,0.0437016024448820,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448820,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448818,0.0437016024448819,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448823,-0.0437016024448824,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448818,0.0437016024448819,0.114412280563536,0.141421356237310,0.114412280563537,0.0437016024448823,-0.0437016024448824,-0.114412280563536,-0.141421356237310,-0.114412280563538,-0.0437016024448828,0.0437016024448809,0.114412280563536,0.141421356237310,0.114412280563537,0.0437016024448823,-0.0437016024448814,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448819,0.0437016024448819,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448824,-0.0437016024448814,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448829,0.0437016024448818,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448834,-0.0437016024448813,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448829,0.0437016024448818,0.114412280563536,0.141421356237310,0.0437016024448821,-0.114412280563537,-0.114412280563537,0.0437016024448821,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448821,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448820,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448820,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448814,-0.114412280563537,-0.114412280563537,0.0437016024448818,0.141421356237310,0.0437016024448824,-0.114412280563537,-0.114412280563537,0.0437016024448818,0.141421356237310,0.0437016024448815,-0.114412280563537,-0.114412280563536,0.0437016024448818,0.141421356237310,0.0437016024448825,-0.114412280563537,-0.114412280563537,0.0437016024448808,0.141421356237310,0.0437016024448835,-0.114412280563537,-0.114412280563537,0.0437016024448798,0.141421356237310,0.0437016024448845,-0.114412280563536,-0.114412280563538,0.0437016024448807,0.141421356237310,0.0437016024448835,-0.114412280563537,-0.114412280563538,0.0437016024448816,0.141421356237310,0.0437016024448826,-0.114412280563537,-0.114412280563537,0.0437016024448825,0.141421356237310,0.0437016024448817,-0.114412280563537,-0.114412280563538,0.0437016024448816,0.141421356237310,0.0437016024448827,-0.114412280563536,-0.114412280563537,0.0437016024448825,0.141421356237310,0.0437016024448818,-0.114412280563535,-0.114412280563538,0.0437016024448815,0.141421356237310,0.0437016024448827,-0.114412280563536,-0.114412280563537,0.0437016024448805,0.141421356237310,0.0437016024448821,-0.114412280563537,-0.114412280563537,0.0437016024448821,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448821,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448820,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448820,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448814,-0.114412280563537,-0.114412280563537,0.0437016024448818,0.141421356237310,0.0437016024448824,-0.114412280563537,-0.114412280563537,0.0437016024448818,0.141421356237310,0.0437016024448815,-0.114412280563537,-0.114412280563536,0.0437016024448818,0.141421356237310,0.0437016024448825,-0.114412280563537,-0.114412280563537,0.0437016024448808,0.141421356237310,0.0437016024448835,-0.114412280563537,-0.114412280563537,0.0437016024448798,0.141421356237310,0.0437016024448845,-0.114412280563536,-0.114412280563538,0.0437016024448807,0.141421356237310,0.0437016024448835,-0.114412280563537,-0.114412280563538,0.0437016024448816,0.141421356237310,0.0437016024448826,-0.114412280563537,-0.114412280563537,0.0437016024448825,0.141421356237310,0.0437016024448817,-0.114412280563537,-0.114412280563538,0.0437016024448816,0.141421356237310,0.0437016024448827,-0.114412280563536,-0.114412280563537,0.0437016024448825,0.141421356237310,0.0437016024448818,-0.114412280563535,-0.114412280563538,0.0437016024448815,0.141421356237310,0.0437016024448827,-0.114412280563536,-0.114412280563537,0.0437016024448805,0.141421356237310,0.114412280563537,0.0437016024448821,-0.0437016024448821,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448821,0.0437016024448821,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448821,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448822,0.0437016024448821,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448820,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448822,0.0437016024448820,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448820,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448822,0.0437016024448820,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448822,-0.0437016024448820,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448818,0.0437016024448819,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448823,-0.0437016024448824,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448818,0.0437016024448819,0.114412280563536,0.141421356237310,0.114412280563537,0.0437016024448823,-0.0437016024448824,-0.114412280563536,-0.141421356237310,-0.114412280563538,-0.0437016024448828,0.0437016024448809,0.114412280563536,0.141421356237310,0.114412280563537,0.0437016024448823,-0.0437016024448814,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448819,0.0437016024448819,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448824,-0.0437016024448814,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448829,0.0437016024448818,0.114412280563537,0.141421356237310,0.114412280563537,0.0437016024448834,-0.0437016024448813,-0.114412280563537,-0.141421356237310,-0.114412280563537,-0.0437016024448829,0.0437016024448818,0.114412280563536,0.141421356237310,0.0437016024448821,-0.114412280563537,-0.114412280563537,0.0437016024448821,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448821,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448820,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448820,0.141421356237310,0.0437016024448822,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448823,-0.114412280563537,-0.114412280563537,0.0437016024448819,0.141421356237310,0.0437016024448814,-0.114412280563537,-0.114412280563537,0.0437016024448818,0.141421356237310,0.0437016024448824,-0.114412280563537,-0.114412280563537,0.0437016024448818,0.141421356237310,0.0437016024448815,-0.114412280563537,-0.114412280563536,0.0437016024448818,0.141421356237310,0.0437016024448825,-0.114412280563537,-0.114412280563537,0.0437016024448808,0.141421356237310,0.0437016024448835,-0.114412280563537,-0.114412280563537,0.0437016024448798,0.141421356237310,0.0437016024448845,-0.114412280563536,-0.114412280563538,0.0437016024448807,0.141421356237310,0.0437016024448835,-0.114412280563537,-0.114412280563538,0.0437016024448816,0.141421356237310,0.0437016024448826,-0.114412280563537,-0.114412280563537,0.0437016024448825,0.141421356237310,0.0437016024448817,-0.114412280563537,-0.114412280563538,0.0437016024448816,0.141421356237310,0.0437016024448827,-0.114412280563536,-0.114412280563537,0.0437016024448825,0.141421356237310,0.0437016024448818,-0.114412280563535,-0.114412280563538,0.0437016024448815,0.141421356237310,0.0437016024448827,-0.114412280563536,-0.114412280563537,0.0437016024448805};
    const uint8_t outputStream[] = {1,1,1,0,0,0,1,1,0,1};

    memset(modulated_real, 0, 100*10*sizeof(RADIO_DATA_TYPE));
    memset(modulated_imag, 0, 100*10*sizeof(RADIO_DATA_TYPE));

    uint8_t outputDemod[10] = {0};

    FM<RADIO_DATA_TYPE> fm(100,50, 20, 10);

    ////////////////////////////////////////////////////////////////////////
    /// Modulate Data
    ////////////////////////////////////////////////////////////////////////
    fm.modulate(inputStream, 10, modulated_real, modulated_imag, 1000);

    for(size_t i = 0; i < 10*100; i++)
    {
        ASSERT_NEAR(modulated_real[i], modulatedStream[i], 0.000000001) << "Failed at index " << i << "  " << inputStream[i] << "  " << modulatedStream[i];
    }

    // The receiver is downsampled by 2 transmit 100 samples received 50 samples
    decimate<RADIO_DATA_TYPE>(modulatedStream, input_stream_size, 2);

    ////////////////////////////////////////////////////////////////////////
    /// Demodulate
    ////////////////////////////////////////////////////////////////////////
    ASSERT_EQ(fm.demodulate(modulatedStream, modulatedStream, outputDemod, 500, 50), 10);

    for(size_t i = 0; i < 10; i++)
    {
        ASSERT_EQ(outputDemod[i], outputStream[i]) << "Failed at index " << i;
    }
}


TEST(FM, ModDemodResampledHigherFreq)
{
    // Hello World Packet
    uint8_t inputStream[] = {1,0,1,1,1,0,1,0,1,1};
    const size_t TX_SAMPLE_RATE = 100000;
    const size_t RX_SAMPLE_RATE =  20000;
    const size_t input_stream_size = 10*TX_SAMPLE_RATE;
    RADIO_DATA_TYPE* modulated_real = new RADIO_DATA_TYPE[input_stream_size];
    RADIO_DATA_TYPE* modulated_imag = new RADIO_DATA_TYPE[input_stream_size];
    const uint8_t outputStream[] = {1,0,1,1,1,0,1,0,1,1};

    memset(modulated_real, 0, input_stream_size*sizeof(RADIO_DATA_TYPE));
    memset(modulated_imag, 0, input_stream_size*sizeof(RADIO_DATA_TYPE));

    uint8_t outputDemod[10] = {0};

    FM<RADIO_DATA_TYPE> fm(TX_SAMPLE_RATE,RX_SAMPLE_RATE, 500, 1000);

    ////////////////////////////////////////////////////////////////////////
    /// Modulate Data
    ////////////////////////////////////////////////////////////////////////
    fm.modulate(inputStream, 10, modulated_real, modulated_imag, input_stream_size);

    // The receiver is downsampled by 2 transmit 100 samples received 50 samples
    size_t decimatedPoints = decimate<RADIO_DATA_TYPE>(modulated_real, input_stream_size, 5);

    ////////////////////////////////////////////////////////////////////////
    /// Demodulate
    ////////////////////////////////////////////////////////////////////////
    ASSERT_EQ(fm.demodulate(modulated_real, modulated_imag, outputDemod, decimatedPoints, RX_SAMPLE_RATE), 10);

    for(size_t i = 0; i < 10; i++)
    {
        ASSERT_EQ(outputDemod[i], outputStream[i]) << "Failed at index " << i;
    }
}



